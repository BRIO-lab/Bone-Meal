MyModel
********************  Starting Initialization!  ********************
********************  Finished Initialization!  ********************
********************  Starting Testing!  ********************
Testing: 0it [00:00, ?it/s]
Auto select gpus: [0]
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/pytorch_lightning/trainer/configuration_validator.py:247: LightningDeprecationWarning: The `on_init_start` callback hook was deprecated in v1.6 and will be removed in v1.8.
  rank_zero_deprecation(
/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/pytorch_lightning/trainer/configuration_validator.py:251: LightningDeprecationWarning: The `on_init_end` callback hook was deprecated in v1.6 and will be removed in v1.8.
  rank_zero_deprecation("The `on_init_end` callback hook was deprecated in v1.6 and will be removed in v1.8.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/torch/nn/functional.py:3609: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
Traceback (most recent call last):
  File "/media/sasank/LinuxStorage/Dropbox (UFL)/LitJTML/scripts/test.py", line 80, in <module>
    main(config,wandb_run)
  File "/media/sasank/LinuxStorage/Dropbox (UFL)/LitJTML/scripts/test.py", line 57, in main
    trainer.test(model, data_module)
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 862, in test
    return self._call_and_handle_interrupt(self._test_impl, model, dataloaders, ckpt_path, verbose, datamodule)
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 909, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1166, in _run
    results = self._run_stage()
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1249, in _run_stage
    return self._run_evaluate()
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1295, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 149, in advance
    self._on_evaluation_batch_end(output, **kwargs)
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 281, in _on_evaluation_batch_end
    self.trainer._call_callback_hooks(hook_name, output, *kwargs.values())
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1597, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "/media/sasank/LinuxStorage/Dropbox (UFL)/LitJTML/scripts/callbacks.py", line 157, in on_test_batch_end
    {'my_image_key': wandb.Image(batch['image'], masks={
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/wandb/sdk/data_types/image.py", line 155, in __init__
    self._set_initialization_meta(grouping, caption, classes, boxes, masks)
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/wandb/sdk/data_types/image.py", line 197, in _set_initialization_meta
    masks_final[key] = ImageMask(mask_item, key)
  File "/home/sasank/miniconda3/envs/sasank-jtml-env/lib/python3.9/site-packages/wandb/sdk/data_types/helper_types/image_mask.py", line 169, in __init__
    image = pil_image.fromarray(val["mask_data"].astype(np.int8), mode="L")
Testing DataLoader 0:   0%|                                                                                                                                                                 | 0/21 [00:00<?, ?it/s]test_outputs[0] is of type tensor([[[-0.1768, -0.1768, -0.1866,  ..., -0.0523, -0.0530, -0.0530],
         [-0.1768, -0.1768, -0.1866,  ..., -0.0523, -0.0530, -0.0530],
         [-0.1750, -0.1750, -0.1839,  ..., -0.0449, -0.0462, -0.0462],
         ...,
         [-0.2025, -0.2025, -0.2003,  ..., -0.1285, -0.1269, -0.1269],
         [-0.1992, -0.1992, -0.1963,  ..., -0.1193, -0.1168, -0.1168],
         [-0.1992, -0.1992, -0.1963,  ..., -0.1193, -0.1168, -0.1168]]],
       device='cuda:0')
batch['label'][0] is of type tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')
label_image[0] is of type torch.Size([1024, 1024])